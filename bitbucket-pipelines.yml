image: node:16.19.1
pipelines:
  default:
    - step:
        name: Install Vercel CLI, Pull Vercel Environment Information, Build Project Artifacts and Deploy Project Artifacts to Vercel
        script:
          - export VERCEL_PROJECT_ID=$STG_PROJECT_ID
          - npm install --global vercel
          - vercel pull --yes --environment=preview --token=$STG_VERCEL_TOKEN
          - vercel build --token=$STG_VERCEL_TOKEN
          - vercel deploy --prebuilt  --token=$STG_VERCEL_TOKEN
  branches:
    development:
      - step:
          name: Install Vercel CLI, Pull Vercel Environment Information, Build Project Artifacts and Deploy Project Artifacts to Vercel
          deployment: staging
          script:
            - export VERCEL_PROJECT_ID=$STG_PROJECT_ID
            - npm install --global vercel
            - vercel pull --yes --environment=production --token=$STG_VERCEL_TOKEN
            - vercel build --prod --token=$STG_VERCEL_TOKEN
            - vercel deploy --prebuilt --prod --token=$STG_VERCEL_TOKEN
    master:
      - step:
          name: Install Vercel CLI, Pull Vercel Environment Information, Build Project Artifacts and Deploy Project Artifacts to Vercel
          deployment: production
          script:
            - export VERCEL_PROJECT_ID=$PROD_VERCEL_PROJECT_ID
            - npm install --global vercel
            - vercel pull --yes --environment=production --token=$PROD_VERCEL_TOKEN
            - vercel build --prod --token=$PROD_VERCEL_TOKEN
            - vercel deploy --prebuilt --prod --token=$PROD_VERCEL_TOKEN
